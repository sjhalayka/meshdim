The code works on closed meshes, with no cracks, holes, etc.

See PDF file.
